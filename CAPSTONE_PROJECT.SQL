CREATE TABLE IF NOT EXISTS SALESMAN(
SALESMAN_ID TEXT PRIMARY KEY,
NAME TEXT,
CITY TEXT,
COMISSION TEXT
);
 INSERT INTO SALESMAN(SALESMAN_ID,NAME,CITY,COMISSION)VALUES

('5001','JAMES','NEW YORK','0.15'),
('5002','NAIL','PARIS','0.13'),
('5005','PIT','LONDON','0.11'),
('5006','LYON','PARIS','0.14'),
('5007','PAUL','ROME','0.13'),
('5003','LAUSON','DELHI','0.12');

SELECT * FROM SALESMAN;

CREATE TABLE IF NOT EXISTS CUSTOMER(
CUSTOMER_ID TEXT,
CUST_NAME TEXT PRIMARY KEY,
CITY TEXT,
GRADE TEXT,
SALESMAN_ID TEXT
);
INSERT INTO CUSTOMER (CUSTOMER_ID,CUST_NAME,CITY,GRADE,SALESMAN_ID)VALUES
('3002','NICK','NEW YORK','100','5001'),
('3007','JACK','NEW YORK','200','5002'),
('3006','ROY','DELHI','200','5007'),
('3008','SHAN','CALIFORNIA','300','5003'),
('3005','LOUIS','LONDON','300','5004'),
('3004','GUZAN','PARIS','100','5006');

SELECT * FROM CUSTOMER;

CREATE TABLE IF NOT EXISTS ORDERS(
ORD_ID TEXT PRIMARY KEY,
PURCH_AMOUNT TEXT,
ORD_DATE TEXT,
CUSTOMER_ID TEXT,
SALESMAN_ID TEXT
);

INSERT INTO ORDERS( ORD_ID,PURCH_AMOUNT ,ORD_DATE ,CUSTOMER_ID ,SALESMAN_ID) VALUES

('70009','150.5','2012-10-5','3005','5002'),
('70005','270.65','2012-09-10','3001','5001'),
('70006','65.26','2012-10-5','3002','5003'),
('70002','110.5','2012-08-17','3009','5007'),
('70007','948.5','2012-09-10','3005','5004'),
('70004','2400.6','2012-07-27','3007','5006');

SELECT * FROM ORDERS

SELECT CUSTOMER.CUST_NAME,  SALESMAN.NAME,SALESMAN.CITY
FROM CUSTOMER
JOIN SALESMAN ON CUSTOMER.CITY = SALESMAN.CITY;

SELECT CUSTOMER.CUST_NAME, SALESMAN.NAME
FROM CUSTOMER 
JOIN SALESMAN ON CUSTOMER.SALESMAN_ID = SALESMAN.SALESMAN_ID;

SELECT ORDERS.ORD_ID, CUSTOMER.CUST_NAME, ORDERS.CUSTOMER_ID
FROM ORDERS
JOIN CUSTOMER ON ORDERS.CUSTOMER_ID = CUSTOMER.CUSTOMER_ID
JOIN SALESMAN ON ORDERS.SALESMAN_ID = SALESMAN.SALESMAN_ID
WHERE CUSTOMER.CITY <> SALESMAN.CITY;

SELECT ORDERS.ORD_ID, CUSTOMER.CUST_NAME
FROM ORDERS
JOIN CUSTOMER ON ORDERS.CUSTOMER_ID = CUSTOMER.CUSTOMER_ID;

SELECT CUSTOMER.CUST_NAME AS 'CUSTOMER',CUSTOMER.GRADE AS 'GRADE' FROM ORDERS
JOIN SALESMAN ON ORDERS.SALESMAN_ID = SALESMAN.SALESMAN_ID
JOIN SALESMAN ON ORDERS.CUSTOMER_ID = CUSTOMER.CUSTOMER_ID
WHERE CUSTOMER.GRADE IS NOT NULL;

SELECT CUSTOMER.CUST_NAME AS 'CUSTOMER',
CUSTOMER.CITY AS 'CITY',
SALESMAN.NAME AS 'SALESMAN',
FROM CUSTOMER
JOIN SALESMAN ON CUSTOMER.SALESMAN_ID = SALESMAN.SALESMAN_ID
WHERE SALESMAN.COMMISION BETWEEN 0.12 AND 0.14;

SELECT ORDERS.ORD_ID, CUSTOMER.CUST_NAME, SALESMAN.COMMISION AS 'COMMISION%',
ORDERS.PURCH_AMT * SALESMAN.COMMISION AS 'COMMISION'
FROM ORDERS JOIN SALESMAN  ON ORDERS.SALESMAN_ID = SALESMAN.SALESMAN_ID
JOIN SALESMAN  ON ORDERS.CUSTOMER_ID = SALESMAN.CUSTOMER_ID WHERW CUSTOMER.GRADE >= 200;

SELECT * FROM CUSTOMER 
JOIN ORDERS ON CUSTOMER.CUSTOMER_ID = ORDER.CUSTOMER_ID 
WHERE ORDERS.ORD_DATE = '2012-10-05';
